language: android
jdk: oraclejdk7
env:
  matrix:
  - ANDROID_TARGET=android-19  ANDROID_ABI=armeabi-v7a
android:
  components:
  - build-tools-19.0.0
before_script:
- echo no | android create avd --force -n test -t $ANDROID_TARGET --abi $ANDROID_ABI
- emulator -avd test -no-skin -no-audio -no-window &
- adb wait-for-device
- adb shell input keyevent 82 &
script: "./gradlew connectedAndroidTest"

deploy:
  provider: releases
  api_key:
    secure: WD1XHCCJwritSm3nLl8XmsCWrWynCap/oQP51FOor+IJNmbFO/fn5BmRFUELB1SAE27ioI1NTkmvcwPMjMw4t84s6wdWHDVyU6deb5zfx1KLDFKYXNtQvSdm3gPwZROuyTm3Y/G2BcO3XlTGSUjSLpYOOxy7AzglJAmjdrBYRdo2mSYfUn9W/YmCiYXMo6UPl/dLz+iMnRmXnA7BYaZNHuHvbEVVU0jjO+4USTl4YedDXCi9M/1IuHgFNP8oHZKIZDNPZYhX5mgLW8mBBCFcjNm3njM1y/JJgDV20Ye2Px7yY09fxn2bbutleP0t9JAUVPEdQKVQxGFbw5eXnKk5LCZio2YvPXKToG2M0nNDUBAacyE5/9AEsvBtF42V7hoDDahAhZB7G776JbureRf8EN/ALa21VqNeuR/vQoqkyBMYIeaJEMCr4y4zFydf218mGdp+vE6IB5kSuM8I/2WqpVMsfgF4daxNXl8iLfpQXSc96TGAMtCtojjbIUDLakggSvuPIvuUNUmvuoF+AfJHL+94hOkqSolnxsKyMgfN9vldG77u+0beYCrIvWB5/LNnHXnTvS3pOCB1HVFfmmFPKoDPzCcNYKwIokxxE+RHfEj+eZvR4tc08Snzp6KOxfnksRhJrw79QS2ceNaest06sNNJ1StGuiBkG7sdoUiBVvI=
  file: 
    - "build/apk/android-tdd-playground-debug-unaligned.apk"
    - "build/apk/android-tdd-playground-debug-test-unaligned.apk"
  skip_cleanup: true
  on:
    tags: true
